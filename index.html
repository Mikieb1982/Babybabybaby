<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Baby Name Generator & Ideas | The Stork Name Drop</title>
    <meta name="description" content="Expecting parents? Find perfect baby name ideas with our fun baby name generator. Explore unique names by gender, origin, style, name meanings, and popular baby name trends.">

    <link rel="icon" href="assets/logo.png" type="image/png">

    <script type="module">
        // ... (Firebase code commented out as before) ...
        // console.log("Firebase initialization skipped (commented out).");
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwind CSS Configuration
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Nunito Sans"', 'sans-serif'],
                        serif: ['Georgia', 'serif'],
                        typewriter: ['"Special Elite"', 'monospace'],
                    },
                    colors: {
                        'stork-title': '#2C3E50', // Dark Slate Blue
                        'stork-text': '#34495E',  // Wet Asphalt
                        'stork-accent': '#1ABC9C', // Turquoise
                        'stork-accent-hover': '#16A085', // Green Sea
                        'soft-beige': '#F7F3E9', // A softer beige
                        'sky-100': '#E0F2FE',    // Light Sky Blue (for gradient)
                        'indigo-200': '#C7D2FE', // Lighter Indigo (for gradient)
                        'dark-text': '#374151',
                        'medium-gray': '#6B7280',
                        'button-active': '#60A5FA',
                        'button-active-hover': '#3B82F6',
                        'button-inactive-hover-bg': '#F9FAFB',
                        'button-inactive-hover-border': '#1F2937',
                        'error-red': '#EF4444',
                        'save-button': '#34D399',
                        'save-button-hover': '#059669',
                        'remove-button': '#F87171',
                        'remove-button-hover': '#DC2626',
                        'copy-button': '#9CA3AF',
                        'copy-button-hover': '#4B5563',
                        'accent-muted': '#64748b',
                        'accent-muted-light': '#cbd5e1',
                        'off-white': '#f8fafc', // Very light gray, almost white
                        'indigo-100': '#e0e7ff',
                        'indigo-700': '#4338ca',
                        'amber-100': '#fef3c7',
                        'amber-500': '#f59e0b'
                    },
                    animation: {
                        'fade-in': 'fade-in 0.5s ease-out',
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fade-in-down': 'fade-in-down 0.5s ease-out',
                        'fade-out-up': 'fade-out-up 0.5s ease-out',
                        'slide-in-from-left': 'slide-in-from-left 0.5s ease-out',
                        'slide-out-to-right': 'slide-out-to-right 0.5s ease-out',
                        'slide-in-from-right': 'slide-in-from-right 0.3s ease-out',
                        'slide-out-to-left': 'slide-out-to-left 0.3s ease-out',
                        'blink-caret': 'blink-caret .75s step-end infinite',
                        'button-icon-hover': 'button-icon-hover 0.3s ease-in-out'
                    },
                    keyframes: {
                        'fade-in': { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        'fade-in-down': { '0%': { opacity: '0', transform: 'translateY(-10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        'fade-out-up': { 'from': { opacity: '1', transform: 'translateY(0px)' }, 'to': { opacity: '0', transform: 'translateY(-10px)' } },
                        'slide-in-from-left': { '0%': { transform: 'translateX(-100%)' }, '100%': { transform: 'translateX(0)' } },
                        'slide-out-to-right': { 'from': { transform: 'translateX(0)' }, 'to': { transform: 'translateX(100%)' } },
                        'slide-in-from-right': { '0%': { transform: 'translateX(100%)' }, '100%': { transform: 'translateX(0)' } },
                        'slide-out-to-left': { 'from': { transform: 'translateX(0)' }, 'to': { transform: 'translateX(-100%)' } },
                        'blink-caret': {
                            'from, to': { borderColor: 'transparent' },
                            '50%': { borderColor: '#1ABC9C' } /* Use stork-accent color */
                        },
                        'button-icon-hover': {
                            '0%, 100%': { transform: 'translateY(0) rotate(0deg)' },
                            '50%': { transform: 'translateY(-2px) rotate(5deg)'}
                        }
                    },
                }
            }
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,opsz,wght@0,6..12,400;0,6..12,600;0,6..12,700;1,6..12,400&family=Special+Elite&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>

    <style>
        /* Basic styles */
        .btn { @apply px-4 py-2 rounded-lg transition duration-200 ease-in-out shadow-md; } /* Slightly larger rounding */
        .btn-primary {
            @apply bg-gradient-to-br from-stork-accent to-teal-400 text-white hover:from-stork-accent-hover hover:to-teal-500 font-semibold;
        }
        .btn-primary img { @apply group-hover:animate-button-icon-hover; }

        .btn-secondary { @apply bg-gray-200 text-stork-text hover:bg-gray-300; }
        .btn-feedback { @apply transform active:scale-95; }

        /* Form element styles */
        select, input[type="text"] {
            @apply rounded-md border-gray-300 shadow-sm focus:border-stork-accent focus:ring focus:ring-stork-accent focus:ring-opacity-50 p-2.5;
        }
        input[type="radio"] { @apply h-4 w-4 text-stork-accent focus:ring-stork-accent border-gray-300; }
        input[type="range"] { @apply w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-stork-accent; }
        input[type="range"]::-webkit-slider-thumb { @apply bg-stork-accent h-5 w-5 rounded-full shadow-md appearance-none; }
        input[type="range"]::-moz-range-thumb {  @apply bg-stork-accent h-5 w-5 rounded-full shadow-md appearance-none; }


        /* Loader */
        .loader {
            border: 4px solid #e0f2fe; /* Light sky */
            border-top: 4px solid #1ABC9C; /* Stork Accent */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Name card styles */
        .name-card {
            @apply bg-white p-4 rounded-xl shadow-lg border border-gray-200/50 mb-4 transition-all duration-300 hover:shadow-xl hover:border-stork-accent; /* Stronger border on hover */
        }
        .name-card h3 {
            margin-bottom: 0.5rem;
            @apply text-stork-title font-semibold text-xl; /* Slightly larger name */
        }
        .name-card p {
            @apply text-stork-text mb-1 text-base leading-relaxed; /* Added leading-relaxed */
        }
        .name-card .tags span {
            @apply inline-block bg-teal-100 text-teal-700 text-sm font-semibold mr-2 px-3 py-1 rounded-full; /* Adjusted to teal for theme consistency */
        }


        /* Typewriter Target Styles */
        #name-typewriter-target {
            font-family: 'Special Elite', monospace;
            font-size: 3rem; /* Larger for more impact */
            line-height: 3.5rem;
            color: #2C3E50;
            text-align: center;
            display: block;
            overflow: hidden;
            white-space: nowrap;
            width: 100%;
            min-height: 3.5rem;
            margin-bottom: 1.5rem; /* More space below */
        }

        #name-typewriter-target.typing::after {
            content: '|';
            display: inline-block;
            animation: blink-caret .75s step-end infinite;
            margin-left: 8px;
            vertical-align: baseline;
            color: #1ABC9C;
            font-size: 3rem;
            line-height: 3.5rem;
        }

        /* Full height layout */
        html, body {
            min-height: 100%;
            display: flex;
            flex-direction: column;
        }
        body {
            flex-grow: 1;
            font-family: 'Nunito Sans', sans-serif;
            color: #34495E;
        }
        main {
            flex-grow: 1;
        }
        /* Ensure letter buttons are styled and spaced */
        #first-letter-inputs button {
            @apply p-2.5 m-1 border border-gray-300 rounded-lg text-sm hover:bg-stork-accent hover:text-white hover:border-stork-accent transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-stork-accent focus:ring-opacity-50 hover:scale-105 active:scale-95;
        }
        #first-letter-inputs button.selected {
            @apply bg-stork-accent text-white border-stork-accent;
        }
        /* Ensure body has top padding if header is fixed */
        body.has-fixed-header {
            padding-top: 72px; /* Adjusted for potentially taller header due to padding/logo */
        }
        /* Custom scrollbar for a cleaner look (optional) */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #1ABC9C; /* Stork Accent */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #16A085; /* Stork Accent Hover */
        }

    </style>

    <script type="text/javascript">
      var _iub = _iub || [];
      _iub.csConfiguration = {"siteId":4012598,"cookiePolicyId":20858973,"lang":"en","storage":{"useSiteId":true}};
    </script>
    <script type="text/javascript" src="https://cs.iubenda.com/autoblocking/4012598.js"></script>
    <script type="text/javascript" src="//cdn.iubenda.com/cs/gpp/stub.js"></script>
    <script type="text/javascript" src="//cdn.iubenda.com/cs/iubenda_cs.js" charset="UTF-8" async></script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "The Stork Name Drop",
      "url": "https://www.thestorknamedrop.com/index.html",
      "description": "Expecting parents? Find perfect baby name ideas with our fun baby name generator. Explore unique names by gender, origin, style, name meanings, and popular baby name trends.",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://www.thestorknamedrop.com/index.html#generator-controls",
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "How to Use The Stork Name Drop Baby Name Generator",
      "description": "Find the perfect baby name by selecting gender, origin, length, and style preferences.",
      "step": [
        {
          "@type": "HowToStep",
          "name": "Set Gender Preference",
          "text": "Choose 'Any', 'Boy', 'Girl', or 'Neutral' for name suggestions."
        },
        {
          "@type": "HowToStep",
          "name": "Select Name Origin",
          "text": "Pick a language or origin for the names, or choose 'Any Origin'."
        },
        {
          "@type": "HowToStep",
          "name": "Filter by First Letter (Optional)",
          "text": "Select a starting letter for the baby names."
        },
        {
          "@type": "HowToStep",
          "name": "Choose Name Length",
          "text": "Specify 'Any', 'Short (3-5 chars)', 'Medium (6-8 chars)', or 'Long (9+ chars)'."
        },
        {
          "@type": "HowToStep",
          "name": "Adjust Name Style",
          "text": "Use the slider to indicate preference from 'Traditional' to 'Unique' names."
        },
        {
          "@type": "HowToStep",
          "name": "Generate Name",
          "text": "Click 'Drop a Name!' to see your generated baby name and details like meaning and origin."
        }
      ],
      "image": "https://www.thestorknamedrop.com/assets/logo.png",
      "author": {
        "@type": "Organization",
        "name": "The Stork Name Drop"
      },
      "datePublished": "2025-05-23"
    }
    </script>
</head>

<body class="font-sans text-stork-text overflow-x-hidden bg-gradient-to-br from-sky-100 to-indigo-200 bg-fixed pt-16 has-fixed-header">
    <header class="fixed top-0 left-0 right-0 z-50 py-4 px-4 md:px-8 bg-white/90 backdrop-blur-lg shadow-lg" role="banner">
        <div class="container mx-auto flex justify-between items-center">
            <a href="index.html" title="The Stork Name Drop Home" class="z-20 flex items-center space-x-2">
                <img src="assets/logo.png" alt="The Stork Name Drop Logo - a stylized stork carrying a baby."
                     class="h-10 w-10 sm:h-12 sm:w-12 object-contain rounded-md"
                     onerror="this.onerror=null; this.src='https://placehold.co/48x48/D1E8E2/34495E?text=Logo';">
                <span class="hidden sm:inline text-xl font-semibold text-stork-title">Stork Name Drop</span>
            </a>

            <nav role="navigation" class="flex space-x-3 sm:space-x-5 items-center">
                <a href="index.html" class="text-sm sm:text-base text-stork-accent font-semibold hover:text-stork-accent-hover transition duration-200">Home</a>
                <a href="#generator-controls" id="top-nav-generator-link" class="text-sm sm:text-base text-stork-text hover:text-stork-accent transition duration-200 font-medium">Generator</a>
                <a href="blog.html" class="text-sm sm:text-base text-stork-text hover:text-stork-accent transition duration-200 font-medium">Blog</a>
                <a href="datasources.html" class="text-sm sm:text-base text-stork-text hover:text-stork-accent transition duration-200 font-medium">Data</a>
                <a href="aboutus.html" class="text-sm sm:text-base text-stork-text hover:text-stork-accent transition duration-200 font-medium">About</a>
            </nav>
        </div>
    </header>

    <section id="showcase" class="py-8 md:py-12 text-center relative" aria-labelledby="page-title">
        <h1 id="page-title" class="sr-only">The Stork Name Drop - Baby Name Generator</h1>
        <img src="assets/indextitle.png" alt="The Stork Name Drop - Decorative title image for baby name generator"
             class="w-full h-auto mb-4 max-w-3xl mx-auto object-contain"
             onerror="this.onerror=null; this.src='https://placehold.co/1200x200/ffffff00/2C3E50?text=The+Stork+Name+Drop&font=specialelite&fontsize=60'; this.style.border='1px dashed #ccc';">
        <p class="text-stork-text text-lg md:text-xl max-w-2xl mx-auto leading-relaxed">Discover perfect baby name ideas for your little one with our playful name generator! Helping expecting parents find unique baby names.</p>
    </section>

    <main role="main" class="max-w-4xl mx-auto bg-off-white/95 backdrop-blur-md p-6 sm:p-8 md:p-10 rounded-2xl border border-gray-200/70 shadow-xl my-10 animate-fade-in-down">

        <fieldset id="generator-controls" class="space-y-10 mb-12" aria-labelledby="generator-legend">
            <legend id="generator-legend" class="text-3xl md:text-4xl text-stork-title font-semibold mb-8 text-center border-b-2 border-stork-accent/50 pb-4">Find Unique Baby Names</legend>

            <section id="gender-selection" aria-labelledby="gender-selection-label">
                <h2 id="gender-selection-label" class="block text-xl md:text-2xl text-stork-text font-semibold mb-4">Gender Preference:</h2>
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-x-4 gap-y-3">
                    <div class="flex items-center"> <input type="radio" id="gender-any" name="gender" value="any" checked class="mr-2.5"> <label for="gender-any" class="text-base md:text-lg cursor-pointer hover:text-stork-accent">Any</label> </div>
                    <div class="flex items-center"> <input type="radio" id="gender-boy" name="gender" value="boy" class="mr-2.5"> <label for="gender-boy" class="text-base md:text-lg cursor-pointer hover:text-stork-accent">Boy</label> </div>
                    <div class="flex items-center"> <input type="radio" id="gender-girl" name="gender" value="girl" class="mr-2.5"> <label for="gender-girl" class="text-base md:text-lg cursor-pointer hover:text-stork-accent">Girl</label> </div>
                    <div class="flex items-center"> <input type="radio" id="gender-neutral" name="gender" value="neutral" class="mr-2.5"> <label for="gender-neutral" class="text-base md:text-lg cursor-pointer hover:text-stork-accent">Neutral</label> </div>
                </div>
            </section>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-10">
                <section id="language-selection" aria-labelledby="language-selection-label">
                    <h2 id="language-selection-label" class="block text-xl md:text-2xl text-stork-text font-semibold mb-3">Origin:</h2>
                    <label for="language-select" class="sr-only">Select language or origin</label>
                    <select id="language-select" name="language" class="w-full p-3 text-base border">
                        <option value="all">Any Origin</option>
                        <option value="english">English</option>
                        <option value="german">German</option>
                        <option value="japanese">Japanese</option>
                        <option value="spanish">Spanish</option>
                        <option value="french">French</option>
                        <option value="italian">Italian</option>
                        </select>
                </section>
                <section id="letter-filter" aria-labelledby="letter-filter-label">
                    <h2 id="letter-filter-label" class="block text-xl md:text-2xl text-stork-text font-semibold mb-3">Starts with letter:</h2>
                    <div id="first-letter-inputs" class="flex flex-wrap gap-1.5" role="group" aria-label="Select starting letter">
                         <span class="text-sm text-gray-500 p-2">Select a letter (optional)</span>
                    </div>
                    <input type="hidden" id="selected-letter" value="" aria-hidden="true">
                </section>
            </div>

            <section id="length-filter" aria-labelledby="length-filter-label">
                <h2 id="length-filter-label" class="block text-xl md:text-2xl text-stork-text font-semibold mb-4">Name Length:</h2>
                 <div class="grid grid-cols-2 sm:grid-cols-4 gap-x-4 gap-y-3">
                    <div class="flex items-center"> <input type="radio" id="length-any" name="length" value="any" checked class="mr-2.5"> <label for="length-any" class="text-base md:text-lg cursor-pointer hover:text-stork-accent">Any</label> </div>
                    <div class="flex items-center"> <input type="radio" id="length-short" name="length" value="short" class="mr-2.5"> <label for="length-short" class="text-base md:text-lg cursor-pointer hover:text-stork-accent">Short (3-5 char)</label> </div>
                    <div class="flex items-center"> <input type="radio" id="length-medium" name="length" value="medium" class="mr-2.5"> <label for="length-medium" class="text-base md:text-lg cursor-pointer hover:text-stork-accent">Medium (6-8 char)</label> </div>
                    <div class="flex items-center"> <input type="radio" id="length-long" name="length" value="long" class="mr-2.5"> <label for="length-long" class="text-base md:text-lg cursor-pointer hover:text-stork-accent">Long (9+ char)</label> </div>
                </div>
            </section>

            <section id="style-slider" aria-labelledby="style-slider-label">
                <div class="flex justify-between items-center mb-3">
                    <h2 id="style-slider-label" class="text-xl md:text-2xl text-stork-text font-semibold">Name Style:</h2>
                    <span id="slider-feedback" class="text-medium-gray text-base md:text-lg font-medium bg-gray-100 px-3 py-1 rounded-md" aria-live="polite">Balanced</span>
                </div>
                <div class="flex items-center justify-between text-medium-gray mb-1 text-sm md:text-base">
                    <span aria-hidden="true">Traditional</span>
                    <span aria-hidden="true">Unique</span>
                </div>
                <label for="style-range" class="sr-only">Name style slider: from traditional to unique</label>
                <input id="style-range" type="range" min="0" max="100" value="50" class="w-full" aria-describedby="slider-feedback">
            </section>

            <div class="text-center pt-6">
                <button id="generate-btn" class="btn btn-primary w-auto px-10 py-4 shadow-lg btn-feedback flex justify-center items-center mx-auto group" disabled>
                    <img src="assets/drop.png" alt="" class="h-8 w-8 sm:h-10 sm:w-10 mr-3 transition-transform duration-300">
                    <span class="text-xl sm:text-2xl font-bold">Drop a Name!</span>
                </button>
            </div>
        </fieldset>

        <section id="results-section" class="mt-16 animate-fade-in" aria-labelledby="results-heading">
            <h2 id="results-heading" class="text-3xl md:text-4xl text-stork-title font-semibold mb-8 text-center border-b-2 border-stork-accent/50 pb-4">Your Generated Name</h2>
            <div id="results-container" class="min-h-[200px] relative p-4 bg-white/50 rounded-xl shadow-inner">
                <div id="loading-indicator" class="loader" style="display: none;" role="status" aria-label="Loading names"></div>
                <div id="result-display" class="text-stork-text" aria-live="polite">
                    <h3 id="name-typewriter-target" class="font-typewriter" aria-label="Generated name"></h3>
                    <div id="name-details" class="text-center mt-4 space-y-1 leading-relaxed"></div>
                    <p id="results-placeholder" class="text-center text-medium-gray text-xl italic mt-10 leading-relaxed">Searching for baby names...</p>
                </div>
                <p id="results-message" class="text-center text-medium-gray mt-6 text-lg leading-relaxed" style="display:none;" role="alert"></p>
            </div>
        </section>

        <hr class="my-12 border-gray-300/70">

        <div id="additional-info" class="space-y-12">
            <section id="related-names-section" class="hidden" aria-labelledby="related-names-heading">
                <h2 id="related-names-heading" class="text-2xl md:text-3xl text-stork-title font-semibold mb-6 text-center">Similar Names You Might Like</h2>
                <div id="related-names-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
            </section>

            <section id="famous-namesakes-section" class="hidden" aria-labelledby="famous-namesakes-heading">
                <h2 id="famous-namesakes-heading" class="text-2xl md:text-3xl text-stork-title font-semibold mb-6 text-center">Famous Namesakes / Mentions</h2>
                <div id="famous-namesakes-container" class="text-stork-text bg-sky-50 p-6 rounded-xl border border-sky-200/80 shadow-md">
                    <p class="text-center text-medium-gray italic">No information available yet.</p>
                </div>
            </section>
        </div>
    </main>

    <footer role="contentinfo" class="bg-gray-800 text-gray-300 text-center p-6 mt-auto text-sm border-t border-gray-700">
         © 2025 The Stork Name Drop. All rights reserved. | <a href="impressum.html" class="hover:text-stork-accent hover:underline">Impressum</a> | <a href="privacypolicy.html" class="hover:text-stork-accent hover:underline">Privacy Policy</a> | <a href="terms.html" class="hover:text-stork-accent hover:underline">Terms of Service</a> </footer>


    <script>
        // --- DOM Element References ---
        const topNavGeneratorLink = document.getElementById('top-nav-generator-link');
        const generateBtn = document.getElementById('generate-btn');
        const resultDisplay = document.getElementById('result-display');
        const nameTypewriterTarget = document.getElementById('name-typewriter-target');
        const nameDetailsContainer = document.getElementById('name-details');
        const resultsPlaceholder = document.getElementById('results-placeholder');
        const resultsMessage = document.getElementById('results-message');
        const loadingIndicator = document.getElementById('loading-indicator');
        const languageSelect = document.getElementById('language-select');
        const firstLetterInputsContainer = document.getElementById('first-letter-inputs');
        const selectedLetterInput = document.getElementById('selected-letter'); // Hidden input
        const styleSlider = document.getElementById('style-range');
        const sliderFeedback = document.getElementById('slider-feedback');
        const relatedNamesContainer = document.getElementById('related-names-container');
        const famousNamesakesContainer = document.getElementById('famous-namesakes-container');
        const relatedNamesSection = document.getElementById('related-names-section');
        const famousNamesakesSection = document.getElementById('famous-namesakes-section');

        // --- State Variables ---
        let nameDatabase = []; // Holds data for the currently selected language/origin
        let dataLoaded = false;
        let currentNameObject = null; // Stores the currently displayed name object
        let typingInterval = null; // To manage the typewriter interval

        // --- Embedded Mock Data ---
        const mockNamesAll = [
            {"name": "Alex", "gender": "neutral", "origin": "Greek", "meaning": "Defender of mankind", "popularity": 70, "tags": ["classic", "unisex"], "related": ["Jordan", "Taylor", "Kai"], "famous_namesakes": "Alex Trebek, Alex Ferguson"},
            {"name": "Seraphina", "gender": "girl", "origin": "Hebrew", "meaning": "Fiery-winged", "popularity": 25, "tags": ["unique", "angelic", "elegant"], "related": ["Angelina", "Gabriella", "Evangeline"], "famous_namesakes": "Seraphina Affleck (daughter of Ben Affleck and Jennifer Garner)"},
            {"name": "Mateo", "gender": "boy", "origin": "Spanish", "meaning": "Gift of God", "popularity": 80, "tags": ["classic", "strong", "popular"], "related": ["Leo", "Lucas", "Santiago"], "famous_namesakes": "Mateo Kovacic (footballer), Mateo Alemán (novelist)"},
            {"name": "Yuki", "gender": "neutral", "origin": "Japanese", "meaning": "Snow; Happiness", "popularity": 40, "tags": ["nature", "gentle", "short"], "related": ["Kenji", "Sakura", "Haru"], "famous_namesakes": "Yuki Kajiura (composer), Yuki Tsunoda (F1 driver)"},
            {"name": "Isla", "gender": "girl", "origin": "Scottish", "meaning": "Island", "popularity": 85, "tags": ["nature", "trendy", "short"], "related": ["Ava", "Olivia", "Freya"], "famous_namesakes": "Isla Fisher (actress)"},
            {"name": "Elias", "gender": "boy", "origin": "Hebrew", "meaning": "My God is the Lord", "popularity": 72, "tags": ["biblical", "classic", "gentle"], "related": ["Elijah", "Samuel", "Noah"], "famous_namesakes": "Elias Howe (inventor), Elias Koteas (actor)"}
        ];

        const mockEnglishNames = [
            {"name": "William", "gender": "boy", "origin": "English", "meaning": "Resolute protector", "popularity": 90, "tags": ["royal", "traditional", "strong"], "related": ["Charles", "Henry", "James"], "famous_namesakes": "William Shakespeare, Prince William"},
            {"name": "Poppy", "gender": "girl", "origin": "English", "meaning": "Flower name", "popularity": 40, "tags": ["floral", "modern", "sweet"], "related": ["Daisy", "Lily", "Rosie"], "famous_namesakes": "Poppy Delevingne (model), Poppy Montgomery (actress)"},
            {"name": "Arthur", "gender": "boy", "origin": "English", "meaning": "Bear man; Noble strength", "popularity": 75, "tags": ["legendary", "classic", "regal"], "related": ["Alfred", "Edward", "George"], "famous_namesakes": "Arthur Conan Doyle, King Arthur"},
            {"name": "Willow", "gender": "girl", "origin": "English", "meaning": "Slender, graceful", "popularity": 55, "tags": ["nature", "elegant", "bohemian"], "related": ["Hazel", "Summer", "Skye"], "famous_namesakes": "Willow Smith (singer), Willow Shields (actress)"},
            {"name": "Oliver", "gender": "boy", "origin": "English", "meaning": "Olive tree", "popularity": 92, "tags": ["popular", "classic", "gentle"], "related": ["Oscar", "Leo", "Felix"], "famous_namesakes": "Oliver Cromwell, Oliver Twist (character)"},
            {"name": "Florence", "gender": "girl", "origin": "English", "meaning": "Flourishing, prosperous", "popularity": 60, "tags": ["vintage", "elegant", "city"], "related": ["Beatrice", "Clara", "Eleanor"], "famous_namesakes": "Florence Nightingale, Florence Welch (singer)"}
        ];


        // --- Functions ---

        function showLoading(show) {
            if (loadingIndicator) {
                loadingIndicator.style.display = show ? 'block' : 'none';
            }
        }

        function showResultsMessage(message, isError = false) {
            if (resultsMessage) {
                resultsMessage.textContent = message;
                resultsMessage.style.display = message ? 'block' : 'none';
                resultsMessage.className = isError ? 'text-center text-error-red mt-4 text-base' : 'text-center text-medium-gray mt-4 text-base';
            }
            if (resultsPlaceholder) resultsPlaceholder.style.display = 'none';
            if (nameTypewriterTarget) nameTypewriterTarget.textContent = '';
            if (nameDetailsContainer) nameDetailsContainer.innerHTML = '';
        }

        async function loadNameData(language) {
            dataLoaded = false;
            showLoading(true);
            if(generateBtn) generateBtn.disabled = true;
            if (resultsPlaceholder) {
                resultsPlaceholder.textContent = 'Searching for baby names...';
                resultsPlaceholder.style.display = 'block';
            }
            showResultsMessage('');

            let filename;
            let useMockData = false;

            switch (language) {
                case 'english': nameDatabase = [...mockEnglishNames]; dataLoaded = true; useMockData = true; filename = 'english_names.json (mocked)'; break;
                case 'german': filename = 'german_names.json'; break;
                case 'japanese': filename = 'japanese_names.json'; break;
                case 'spanish': filename = 'spanish_names.json'; break;
                case 'french': filename = 'french_names.json'; break;
                case 'italian': filename = 'italian_names.json'; break;
                case 'all': default: nameDatabase = [...mockNamesAll]; dataLoaded = true; useMockData = true; filename = 'names.json (mocked)'; break;
            }

            if (useMockData) {
                if (resultsPlaceholder) resultsPlaceholder.style.display = 'none';
                if (nameDatabase.length === 0) showResultsMessage(`No names found in mock data (${filename}). Consider choosing another origin or criteria for more baby name ideas.`);
                showLoading(false);
                if(generateBtn) generateBtn.disabled = !(dataLoaded && nameDatabase.length > 0);
                if (dataLoaded && nameDatabase.length > 0 && resultsPlaceholder) {
                    resultsPlaceholder.textContent = 'Ready! Click "Drop a Name!" to generate unique baby names.';
                    resultsPlaceholder.style.display = 'block';
                }
                return;
            }

            let finalUrlToFetch;
            try {
                const base = document.baseURI;
                if (!base) throw new Error("document.baseURI is not available.");
                const urlObject = new URL(filename, base);
                urlObject.searchParams.append('v', new Date().getTime());
                finalUrlToFetch = urlObject.href;
                const response = await fetch(finalUrlToFetch);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status} ${response.statusText} (URL: ${finalUrlToFetch})`);
                nameDatabase = await response.json();
                dataLoaded = true;
                if (resultsPlaceholder) resultsPlaceholder.style.display = 'none';
                if (nameDatabase.length === 0) showResultsMessage(`No baby names found in ${filename}. Please try different criteria or origins for more results.`);
            } catch (error) {
                const attemptedUrlForLog = finalUrlToFetch || `(URL construction failed for ${filename})`;
                console.error(`Error in loadNameData. Lang: ${language}, File: ${filename}, URL: ${attemptedUrlForLog}. Error:`, error);
                let displayMessage = `Failed to load baby name data for ${language.toUpperCase()} (${filename}). Try 'Any Origin' or 'English' for more name ideas. (Details: ${error.message})`;
                if (error instanceof TypeError && error.message.toLowerCase().includes("failed to parse url")) {
                    displayMessage = `Fetch error: Failed to parse URL for "${filename}". (Details: ${error.message})`;
                } else if (error.message.includes("HTTP error!")) {
                    displayMessage = `Network error fetching ${filename}: ${error.message}`;
                }
                showResultsMessage(displayMessage, true);
                nameDatabase = [];
            } finally {
                showLoading(false);
                if(generateBtn) generateBtn.disabled = !(dataLoaded && nameDatabase.length > 0);
                if (dataLoaded && nameDatabase.length > 0 && resultsPlaceholder) {
                    resultsPlaceholder.textContent = 'Ready! Click "Drop a Name!" to generate unique baby names.';
                    resultsPlaceholder.style.display = 'block';
                } else if (!dataLoaded && resultsPlaceholder && !useMockData) {
                    resultsPlaceholder.textContent = `Could not load baby names for ${language.toUpperCase()}. Try 'Any Origin' or 'English' for more name ideas.`;
                    resultsPlaceholder.style.display = 'block';
                }
            }
        }

        function populateLetterButtons() {
            if (!firstLetterInputsContainer) return;
            firstLetterInputsContainer.innerHTML = '';
            const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('');
            alphabet.forEach(letter => {
                const button = document.createElement('button');
                button.type = 'button';
                button.textContent = letter;
                button.dataset.letter = letter;
                button.addEventListener('click', () => {
                    const currentSelected = firstLetterInputsContainer.querySelector('button.selected');
                    if (currentSelected) currentSelected.classList.remove('selected', 'bg-stork-accent', 'text-white', 'border-stork-accent');
                    if (selectedLetterInput.value === letter) {
                        selectedLetterInput.value = '';
                    } else {
                        button.classList.add('selected', 'bg-stork-accent', 'text-white', 'border-stork-accent');
                        selectedLetterInput.value = letter;
                    }
                });
                firstLetterInputsContainer.appendChild(button);
            });
        }

        function updateSliderFeedback() {
            if (!styleSlider || !sliderFeedback) return;
            const value = parseInt(styleSlider.value);
            if (value < 33) sliderFeedback.textContent = 'Traditional';
            else if (value < 67) sliderFeedback.textContent = 'Balanced';
            else sliderFeedback.textContent = 'Unique';
        }

        function typewriterEffect(text, targetElement, onComplete) {
            if (!targetElement) return;
            if (typingInterval) clearInterval(typingInterval);
            let i = 0;
            targetElement.innerHTML = '';
            targetElement.classList.add('typing');
            typingInterval = setInterval(() => {
                if (i < text.length) {
                    targetElement.innerHTML += text.charAt(i);
                    i++;
                } else {
                    clearInterval(typingInterval);
                    typingInterval = null;
                    targetElement.classList.remove('typing');
                    if (onComplete) onComplete();
                }
            }, 100);
        }

        function displayGeneratedName(nameObj) {
            currentNameObject = nameObj;
            if (resultsPlaceholder) resultsPlaceholder.style.display = 'none';
            showResultsMessage('');
            typewriterEffect(nameObj.name, nameTypewriterTarget, () => {
                if (nameDetailsContainer) {
                    nameDetailsContainer.innerHTML = '';
                    let detailsHTML = '';
                    if (nameObj.meaning) detailsHTML += `<p class="text-xl text-stork-text leading-relaxed"><strong>Meaning:</strong> ${nameObj.meaning}</p>`;
                    if (nameObj.origin) detailsHTML += `<p class="text-base text-medium-gray leading-snug"><strong>Origin:</strong> ${nameObj.origin}</p>`;
                    if (nameObj.gender) detailsHTML += `<p class="text-base text-medium-gray leading-snug"><strong>Gender:</strong> ${nameObj.gender.charAt(0).toUpperCase() + nameObj.gender.slice(1)}</p>`;
                    if (nameObj.tags && nameObj.tags.length > 0) {
                        detailsHTML += `<div class="tags mt-3"><strong>Tags:</strong> ${nameObj.tags.map(tag => `<span class="inline-block bg-teal-100 text-teal-700 text-sm font-semibold mr-2 px-3 py-1 rounded-full">${tag}</span>`).join('')}</div>`;
                    }
                    nameDetailsContainer.innerHTML = detailsHTML;
                }

                if (relatedNamesContainer && relatedNamesSection) {
                    relatedNamesContainer.innerHTML = '';
                    if (nameObj.related && nameObj.related.length > 0) {
                        nameObj.related.forEach(relatedNameStr => {
                            const relatedNameObj = nameDatabase.find(n => n.name.toLowerCase() === relatedNameStr.toLowerCase());
                            const card = document.createElement('div');
                            card.className = 'name-card animate-fade-in';
                            let cardHTML = `<h3>${relatedNameStr}</h3>`;
                            if (relatedNameObj) {
                                if (relatedNameObj.meaning) cardHTML += `<p class="leading-relaxed"><em>${relatedNameObj.meaning}</em></p>`;
                                if (relatedNameObj.origin) cardHTML += `<p class="text-xs leading-snug">Origin: ${relatedNameObj.origin}</p>`;
                                if (relatedNameObj.gender) cardHTML += `<p class="text-xs leading-snug">Gender: ${relatedNameObj.gender.charAt(0).toUpperCase() + relatedNameObj.gender.slice(1)}</p>`;
                            } else {
                                cardHTML += `<p class="text-xs italic leading-snug">Details not available.</p>`;
                            }
                            card.innerHTML = cardHTML;
                            relatedNamesContainer.appendChild(card);
                        });
                        relatedNamesSection.classList.remove('hidden');
                        relatedNamesSection.classList.add('animate-fade-in-down');
                    } else {
                        relatedNamesSection.classList.add('hidden');
                    }
                }

                if (famousNamesakesContainer && famousNamesakesSection) {
                    if (nameObj.famous_namesakes) {
                        famousNamesakesContainer.innerHTML = `<p class="text-lg leading-relaxed">${nameObj.famous_namesakes}</p>`;
                        famousNamesakesSection.classList.remove('hidden');
                        famousNamesakesSection.classList.add('animate-fade-in-down');
                    } else {
                        famousNamesakesContainer.innerHTML = `<p class="text-center text-medium-gray italic leading-relaxed">No famous namesakes information available.</p>`;
                        famousNamesakesSection.classList.add('hidden');
                    }
                }
            });
        }

        function handleGenerateName() {
            if (!dataLoaded || nameDatabase.length === 0) {
                showResultsMessage('Baby name data not loaded or empty. Select language/origin or try again for new name ideas.', true);
                if (resultsPlaceholder) resultsPlaceholder.style.display = 'none';
                return;
            }
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const firstLetter = selectedLetterInput.value.toUpperCase();
            const lengthCategory = document.querySelector('input[name="length"]:checked').value;
            const styleValue = parseInt(styleSlider.value);
            let filteredNames = nameDatabase.filter(name => {
                if (gender !== 'any' && name.gender !== gender) return false;
                if (firstLetter && !name.name.toUpperCase().startsWith(firstLetter)) return false;
                const nameLen = name.name.length;
                if (lengthCategory === 'short' && (nameLen < 3 || nameLen > 5)) return false;
                if (lengthCategory === 'medium' && (nameLen < 6 || nameLen > 8)) return false;
                if (lengthCategory === 'long' && nameLen < 9) return false;
                const popularity = name.popularity === undefined ? 50 : name.popularity;
                if (styleValue < 33 && popularity < 70) return false;
                if (styleValue > 67 && popularity > 30) return false;
                if (styleValue >= 33 && styleValue <= 67 && (popularity <= 30 || popularity >= 70)) return false;
                return true;
            });

            if (filteredNames.length > 0) {
                const randomIndex = Math.floor(Math.random() * filteredNames.length);
                displayGeneratedName(filteredNames[randomIndex]);
            } else {
                showResultsMessage('No baby names match your criteria. Try broadening your search for more name ideas!');
                if (nameTypewriterTarget) nameTypewriterTarget.textContent = '';
                if (nameDetailsContainer) nameDetailsContainer.innerHTML = '';
                if(relatedNamesSection) relatedNamesSection.classList.add('hidden');
                if(famousNamesakesSection) famousNamesakesSection.classList.add('hidden');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            populateLetterButtons();
            updateSliderFeedback();
            loadNameData(languageSelect ? languageSelect.value : 'all');
            if (languageSelect) languageSelect.addEventListener('change', (e) => loadNameData(e.target.value));
            if (styleSlider) styleSlider.addEventListener('input', updateSliderFeedback);
            if (generateBtn) generateBtn.addEventListener('click', handleGenerateName);
            if (topNavGeneratorLink) {
                topNavGeneratorLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    const generatorSection = document.getElementById('generator-controls');
                    if (generatorSection) generatorSection.scrollIntoView({ behavior: 'smooth' });
                });
            }
            // Initialize Feather Icons if you decide to use them
            // if (typeof feather !== 'undefined') {
            //     feather.replace();
            // }
        });
    </script>

</body>
</html>
